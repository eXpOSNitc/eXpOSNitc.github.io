<!DOCTYPE html>
<html lang="en">
  <head>

    <!-- Basic Page Needs
    ================================================== -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
     <title>Pager Module</title>

    <!-- Mobile Specific Metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" href="../img/favicon.jpg"/>

    <!-- CSS
    ================================================== -->       
    <!-- Bootstrap css file-->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <!-- Font awesome css file-->
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <!-- Superslide css file-->
    <link rel="../stylesheet" href="css/superslides.css">
    <!-- Slick slider css file -->
    <link href="../css/slick.css" rel="stylesheet"> 
    <!-- smooth animate css file -->
    <link rel="stylesheet" href="../css/animate.css">  
    <!-- Elastic grid css file -->
    <link rel="stylesheet" href="../css/elastic_grid.css"> 
    <!-- Circle counter cdn css file -->
    <link rel='stylesheet prefetch' href='../css/jquery.circliful.css'>    
    <!-- Default Theme css file -->
    <link id="orginal" href="../css/themes/eucalyptus-theme.css" rel="stylesheet">
    <!-- Main structure css file -->
    <link href="../style.css" rel="stylesheet">
   
    <!-- Google fonts -->
    <link href='../css/opensans.css' rel='stylesheet' type='text/css'>
    <link href='../css/varela.css' rel='stylesheet' type='text/css'>
    <link href='../css/montserrat.css' rel='stylesheet' type='text/css'>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  
 <style type="text/css">
   
   pre{
    font-family: Times new Roman; 
    font-size: 15px;"
   }

 </style>>   

  </head>
  <body> 
     <!-- BEGAIN PRELOADER 
    <div id="preloader">
      <div id="status">&nbsp;</div>
    </div>
     END PRELOADER -->

  
    <!--=========== BEGIN HEADER SECTION ================-->
    <header id="header">
      <!-- BEGIN MENU -->
      <div class="menu_area">
        <nav class="navbar navbar-default navbar-fixed-top past-main" role="navigation"> 
          <div class="container">
          <div class="navbar-header">
            <!-- FOR MOBILE VIEW COLLAPSED BUTTON -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            <!-- LOGO -->

            <!-- TEXT BASED LOGO -->
            <a class="navbar-brand" href="index.html">eXpOS<span>NITC</span></a>
            
                              
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul id="top-menu" class="nav navbar-nav navbar-right main_nav">
	      <li><a href="../index.html">Home</a></li>
              <li><a href="../documentation.html" target="_blank">Documentation</a></li> 
              <li><a href="../Roadmap.html" target="_blank">Roadmap</a></li>
               <li><a href="../faq.html" target="_blank">FAQ</a></li>
              <li><a href="../About_us.html" target="_blank">About Us</a></li>                                     
            </ul>           
          </div>
          </div>     
        </nav>  
      </div>
      <!-- END MENU -->

      
    </header>
		
    <!--=========== End HEADER SECTION ================--> 
    
    <!--begin section-->
    <section id="abi" style="text-align:justify">
		<br>
		<br>
		<br>
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12">
            <div class="about_area">
             
                <!-- START ABOUT HEADING -->
              <div class="heading">
                
                <h2 >Pager Module</h2>
                <br/>
                <br/>
                
                <p> This module is responsible for swapping in and out processes. Swap-out is initiated from the timer interrupt when the free memory is critically low. Similiarly, if there is enough memory available in the system, swap-in is initiated by the timer.</p>.
                </p>
              </div>

                 <br> <br> 
  

<table class="table table-bordered" style="text-align: center;">
    <tr class="success">
        <th style="text-align: center;">Function Number</th>
        <th style="text-align: center;">Function Name</th>
        <th style="text-align: center;">Arguments</th>
        <th style="text-align: center;">Return Value</th>
    </tr>
<tr>
    <td>1</td>
    <td>Swap Out</td>
    <td>PID</td>
    <td>NIL</td>
  </tr>

<tr>
    <td>2</td>
    <td>Swap In</td>
    <td>PID</td>
    <td>NIL</td>
  </tr>
</table>  
                     
<h3>Swap Out</h3>
<i> <b>Description </b></i>: Invoked when the physical memory is critically low. The function chooses a process to swap out, and free it's memory by moving it to the disk. PID of the currently running process is passed as an argument.<br><br>
<pre>
Set the PAGING_PROCESS field in the <a href="../os_design-files/mem_ds.html#ss_table">System Status Table</a> to PID of the current process 
to indicate that the system is going to perform paging.
/* The <a href="../os_modules/Module_5.html">scheduler</a> will schedule only this process and the idle process when swapout in ongoing. */

Choose a process to swap out. (other than the IDLE, Shell or INIT)
	Loop through the <a href="../os_design-files/process_table.html">Process Table</a> and find a process that is in the WAIT_PROCESS state.
	If there are no processes in the WAIT_PROCESS state, find a process in the WAIT_TERMINAL state.
	If there are no processes in the WAIT_PROCESS and WAIT_TERMINAL state, 
                    find the non swapped non running process with the highest TICK.

Set the TICK field of the process table entry of the selected process to 0.
/* When the process goes to swap, TICK starts again */

Call the <b>release_page()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module to deallocate the valid code pages of the process.
Invalidate the <a href="../os_design-files/process_table.html#per_page_table">Page table</a> entry correpsonding to the code pages.

<b>For</b> each heap page that is not shared and is valid {	/* Shared heap pages are not swapped out. */
	Get a free swap block by calling the <b>get_swap_block()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module.
	Store the disk block number in the <a href="../os_design-files/process_table.html#disk_map_table">Disk Map Table</a> entry of the process curresponding to the heap page.
	Use the <b>disk_store()</b> function in the <a href="../os_modules/Module_4.html">Device Manager</a> module to write the heap page to the block found above
	Call the <b>release_page()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module to deallocate the page.
	Invalidate the Page table entry correpsonding to the page.
}

Get three free swap block by calling the <b>get_swap_block()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module.

Use the <b>disk_store()</b> function in the <a href="../os_modules/Module_4.html">Device Manager</a> module to write the two stack pages and 
the user area page to the disk blocks found above.

Call the <b>release_page()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module to deallocate the three page.

Update the Disk Map Table entry of the process to store the disk block numbers of the stack and the user area page.

Invalidate the Page table entries correpsonding to the two stack pages.
Set the USER AREA PAGE NUMBER field in the <a href="../os_design-files/process_table.html">process table</a> to -1.

Set the SWAP_FLAG field in the process table entry of the process to 1.

In the <a href="../os_design-files/mem_ds.html#ss_table">System Status Table</a>, increment the SWAP_COUNT and reset the PAGING_PROCESS back to -1.	
/* The scheduler can now resume normal scheduling */ 

return;
</pre>
Called by the timer interrupt.<br><br>

<b>Question:</b><br>
1. What is the reasoning behind the order of choosing the process to swap out? Why is a process in WAIT_PROCESS swapped out ahead of a process waiting for the terminal? What about processes waiting for the disk? <br>
2. Why is swapping not possible from the idle process?


<h3>Swap In</h3>
<i> <b>Description </b></i>: Invoked when the physical memory is high enough that a process can be swapped in. If a suitable process is found, it is loaded back to the main memory. PID of the currently running process is passed as an argument.<br><br>

<pre>
If there are processes waiting for memory or if there are no processes in the swapped state, Return.
/* Check the WAIT_MEM_COUNT and SWAPPED_COUNT fields of the <a href="../os_design-files/mem_ds.html#ss_table">System Status Table</a> */

Set the PAGING_PROCESS field in the <a href="../os_design-files/mem_ds.html#ss_table">System Status Table</a> to PID of the current process 
to indicate that the system is going to perform paging.
/* The <a href="../os_modules/Module_5.html">scheduler</a> will schedule only this process and the idle process */

/* Find if any swapped out process can be made ready to run if brought into memory. */
Loop through the <a href="../os_design-files/process_table.html">Process Table</a> and find the <b>swapped</b> process in the READY state with the highest TICK.
If there is no such process in the READY state, reset the PAGING_PROCESS field to -1 and Return.

Set the TICK field of the process table entry of the selected process to 0.

<b>For</b> each heap page that is swapped out {	/* Check the <a href="../os_design-files/process_table.html#disk_map_table">Disk Map Table</a>. */
	Call the <b>get_free_page()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module to allocate a memory page.
	Get the disk block number in the <a href="../os_design-files/process_table.html#disk_map_table">Disk Map Table</a> entry of the process corresponding to the heap page.
	Use the <b>disk_load()</b> function in the <a href="../os_modules/Module_4.html">Device Manager</a> module to copy the heap page found above to the memory.
	Free the swap block by calling the <b>release_block()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module.
	Set the Page table entry correpsonding to the page. Reference bit is set to 0, valid bit and write bit are set to 1.
    Invalidate the Disk Map Table entry corresponding to the heap page.
}

Get three free memory pages by calling the <b>get_free_page()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module.

Use the <b>disk_load()</b> function in the <a href="../os_modules/Module_4.html">Device Manager</a> module to load the two stack pages and 
the user area page to the memory allocated above.

Set the Page table entries correpsonding to the two stack pages. The pages are valid, unreferenced and writable.
Set the USER AREA PAGE NUMBER field in the <a href="../os_design-files/process_table.html">process table</a> to page number of the User Area Page.

Call the <b>release_block()</b> function in the <a href="../os_modules/Module_2.html">Memory Manager</a> module to deallocate the three swap blocks.

Invalidate the Disk Map Table entry of the process corresponding to the pages.

Set the SWAP_FLAG field in the process table entry of the process to 0.

In the <a href="../os_design-files/mem_ds.html#ss_table">System Status Table</a>, decrement the SWAP_COUNT and reset the PAGING_PROCESS back to -1.	
/* The scheduler can now resume normal scheduling */ 

return;
</pre>

Called by timer interrupt.<br><br>

<b>Question: </b><br> 1. Is it possible that there are processes waiting for memory, even when MEM_FREE_COUNT > MEM_HIGH? 
<br>
2. Why are code pages not loaded back to memory when the process is swapped in?
<br><br>




                     <!--end-->   
                    <br>
                               </div>
              </div>
            </div>
          </div>
        </div>       
      </div>
       	
		 
    </section>
    
    <!--end section-->
                
 <!--=========== BEGIN FOOTER ================-->
     <footer id="footer">
       <div class="container">
         <div class="row">
blahblahblee
           <div class="col-lg-6 col-md-6 col-sm-6">
             <div class="footer_left">
               <p><a href="http://www.nitc.ac.in/">National Institute of Technology, Calicut</a></p>
             </div>
           </div>
         </div>
       </div>
      </footer>
      <!--=========== END FOOTER ================-->

     <!-- Javascript Files
     ================================================== -->
  
     <!-- initialize jQuery Library -->
    <script src="js/jquery.min.js"></script>
    <!-- Google map -->
    <script src="js/map_js.js"></script>
    <script src="js/jquery.ui.map.js"></script>
     <!-- For smooth animatin  -->
    <script src="js/wow.min.js"></script> 
    <!-- Bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- superslides slider -->
    <script src="js/jquery.superslides.min.js" type="text/javascript"></script>
    <!-- slick slider -->
    <script src="js/slick.min.js"></script>    
    <!-- for circle counter -->
    <script src='js/jquery.circliful.min.js'></script>
    <!-- for portfolio filter gallery -->
    <script src="js/modernizr.custom.js"></script>
    <script src="js/classie.js"></script>
    <script src="js/elastic_grid.min.js"></script>
    <script src="js/portfolio_slider.js"></script>

    <!-- Custom js-->
    <script src="js/custom.js"></script>
  </body>
</html>
